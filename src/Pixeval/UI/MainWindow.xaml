<!--
Pixeval - A Strong, Fast and Flexible Pixiv Client
Copyright (C) 2019-2020 Dylech30th

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.-->

<!--  ReSharper disable Xaml.RedundantResource  -->
<Window x:Class="Pixeval.UI.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:WpfToolkit.Controls;assembly=VirtualizingWrapPanel" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:dragablz="http://dragablz.net/winfx/xaml/dragablz"
        xmlns:i18N="clr-namespace:Pixeval.Objects.I18n" xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:persisting="clr-namespace:Pixeval.Persisting" xmlns:pixeval="clr-namespace:Pixeval" xmlns:primitive="clr-namespace:Pixeval.Objects.Primitive"
        xmlns:svgc="http://sharpvectors.codeplex.com/svgc/" xmlns:system="clr-namespace:System;assembly=System.Runtime" xmlns:userControls="clr-namespace:Pixeval.UI.UserControls"
        xmlns:valueConverters="clr-namespace:Pixeval.Objects.ValueConverters" xmlns:viewModel="clr-namespace:Pixeval.Data.ViewModel" Title="Pixeval"
        Width="1600" Height="900" Deactivated="MainWindow_OnDeactivated"
        Icon="/Resources/pxlogo.ico" KeyDown="MainWindow_OnKeyDown" Loaded="MainWindow_OnLoaded"
        MouseDown="MainWindow_OnMouseDown" TextElement.FontFamily="Microsoft YaHei UI Light"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        WindowStartupLocation="CenterScreen" mc:Ignorable="d">
    <Window.Resources>
        <system:Double x:Key="Divide">
            2
        </system:Double>
        <Storyboard x:Key="UserBrowserOpacityIncreaseAnimation" TargetProperty="(ScrollViewer.Opacity)" TargetName="UserBrowserPageScrollViewer">
            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                             From="0" To="1" Duration="00:00:00.3" />
        </Storyboard>
        <Storyboard x:Key="UserBrowserScaleXIncreaseAnimation" TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)" TargetName="UserBrowserPageScrollViewer">
            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                             From="0" To="1" Duration="00:00:00.3" />
        </Storyboard>
        <Storyboard x:Key="UserBrowserScaleYIncreaseAnimation" TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)" TargetName="UserBrowserPageScrollViewer">
            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                             From="0" To="1" Duration="00:00:00.3" />
        </Storyboard>
        <Storyboard x:Key="ContentContainerOpacityIncreaseAnimation" TargetProperty="(Grid.Opacity)" TargetName="ContentContainer">
            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                             From="1" To="0" Duration="00:00:00.3" />
        </Storyboard>
        <Storyboard x:Key="ContentContainerScaleXIncreaseAnimation" TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)" TargetName="ContentContainer">
            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                             From="1" To="0" Duration="00:00:00.3" />
        </Storyboard>
        <Storyboard x:Key="ContentContainerScaleYIncreaseAnimation" TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)" TargetName="ContentContainer">
            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                             From="1" To="0" Duration="00:00:00.3" />
        </Storyboard>
        <DataTemplate x:Key="TrendsTemplate" DataType="viewModel:Trends">
            <materialDesign:Card Width="300" Height="400" HorizontalAlignment="Center"
                                 VerticalAlignment="Center" Background="White" UniformCornerRadius="10">
                <StackPanel>
                    <Grid>
                        <Image x:Name="ReferImage" Width="300" Height="300"
                               Cursor="Hand" Loaded="ReferImage_OnLoaded" MouseLeftButtonDown="ReferImage_OnMouseLeftButtonDown"
                               Stretch="UniformToFill"
                               Style="{StaticResource ReleaseImageStyle}" />
                        <Grid Background="Transparent" Cursor="Hand" MouseLeftButtonDown="ReferUser_OnMouseLeftButtonDown"
                              Visibility="{Binding IsReferToUser, Converter={StaticResource VisibleIfTrueConverter}}">
                            <Grid Width="120" Height="120" HorizontalAlignment="Center"
                                  VerticalAlignment="Center" Background="Gray" Opacity="0.3">
                                <Grid.Clip>
                                    <EllipseGeometry Center="60 60" RadiusX="60" RadiusY="60" />
                                </Grid.Clip>
                            </Grid>
                            <Image x:Name="ReferUserAvatar" Width="60" Height="60"
                                   Loaded="ReferUserAvatar_OnLoaded" Stretch="UniformToFill"
                                   Style="{StaticResource ReleaseImageStyle}">
                                <Image.Clip>
                                    <RectangleGeometry RadiusX="10" RadiusY="10" Rect="0,0,60,60" />
                                </Image.Clip>
                            </Image>
                        </Grid>
                    </Grid>
                    <StackPanel Margin="0,10,0,0" HorizontalAlignment="Center" Orientation="Horizontal">
                        <TextBlock MaxWidth="180" VerticalAlignment="Bottom" FontSize="20"
                                   Text="{Binding TrendObjName}"
                                   TextTrimming="CharacterEllipsis" TextWrapping="NoWrap" />
                        <TextBlock MaxWidth="75" Margin="5,0,0,0" VerticalAlignment="Bottom"
                                   FontSize="15"
                                   Text="{Binding ByName, StringFormat={} by {0}}"
                                   TextTrimming="CharacterEllipsis" TextWrapping="NoWrap"
                                   Visibility="{Binding IsReferToUser, Converter={StaticResource VisibleIfFalseConverter}}" />
                    </StackPanel>
                    <StackPanel Margin="0,10,0,0" HorizontalAlignment="Center" Orientation="Horizontal">
                        <Image x:Name="PostUserAvatar" Width="45" Height="45"
                               Loaded="PostUserAvatar_OnLoaded"
                               Style="{StaticResource ReleaseImageStyle}">
                            <Image.Clip>
                                <RectangleGeometry RadiusX="5" RadiusY="5" Rect="0,0,45,45" />
                            </Image.Clip>
                        </Image>
                        <StackPanel Margin="15,0,0,0" VerticalAlignment="Center">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock FontSize="12">
                                    <Hyperlink x:Name="PostUserHyperlink" Click="Hyperlink_OnClick" Foreground="#03A9F4">
                                        <TextBlock MaxWidth="75"
                                                   Text="{Binding PostUserName}"
                                                   TextTrimming="CharacterEllipsis" TextWrapping="NoWrap" />
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock FontSize="12" Text="{Binding Type, Converter={StaticResource TrendsStatConverter}, StringFormat={} {0}}" />
                            </StackPanel>
                            <TextBlock MaxWidth="125" Margin="0,5,0,0" FontSize="10"
                                       Foreground="#03A9F4"
                                       Text="{Binding PostDate, Converter={StaticResource DateTimeConverter}}"
                                       TextTrimming="CharacterEllipsis" TextWrapping="NoWrap" />
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </materialDesign:Card>
        </DataTemplate>
        <DataTemplate x:Key="IllustrationTemplate" DataType="viewModel:Illustration">
            <materialDesign:Card UniformCornerRadius="10">
                <Grid x:Name="IllustrationContainer" Width="280" Height="200"
                      ClipToBounds="True" Cursor="Hand" MouseLeftButtonDown="IllustrationContainer_OnMouseLeftButtonDown"
                      PreviewMouseRightButtonDown="IllustrationContainer_OnPreviewMouseRightButtonDown"
                      ToolTip="{Binding Path=Id}">
                    <Grid.ContextMenu>
                        <ContextMenu>
                            <MenuItem x:Name="DownloadNowMenuItem" Click="DownloadNowMenuItem_OnClick"
                                      Header="{x:Static i18N:AkaI18N.DownloadSingleIllustration}" />
                            <MenuItem x:Name="DownloadAllNowMenuItem" Click="DownloadAllNowMenuItem_OnClick"
                                      Header="{x:Static i18N:AkaI18N.DownloadAllInCurrentList}" />
                        </ContextMenu>
                    </Grid.ContextMenu>
                    <Grid.Triggers>
                        <EventTrigger RoutedEvent="Grid.MouseEnter">
                            <BeginStoryboard>
                                <Storyboard TargetProperty="(ScaleTransform.ScaleX)" TargetName="IllustrationThumbnailScaleTransform">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="1" To="1.2" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard TargetProperty="(ScaleTransform.ScaleY)" TargetName="IllustrationThumbnailScaleTransform">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="1" To="1.2" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                        <EventTrigger RoutedEvent="Grid.MouseLeave">
                            <BeginStoryboard>
                                <Storyboard TargetProperty="(ScaleTransform.ScaleX)" TargetName="IllustrationThumbnailScaleTransform">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="1.2" To="1" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard TargetProperty="(ScaleTransform.ScaleY)" TargetName="IllustrationThumbnailScaleTransform">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="1.2" To="1" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Grid.Triggers>
                    <Image x:Name="Thumbnail" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                           Loaded="Thumbnail_OnLoaded" Opacity="0" Stretch="UniformToFill"
                           Unloaded="Thumbnail_OnUnloaded">
                        <Image.Effect>
                            <BlurEffect x:Name="IllustrationThumbnailBlurEffect" KernelType="Gaussian" Radius="1" />
                        </Image.Effect>
                        <Image.RenderTransform>
                            <ScaleTransform x:Name="IllustrationThumbnailScaleTransform" CenterX="140" CenterY="100" ScaleX="1.2" ScaleY="1.2" />
                        </Image.RenderTransform>
                    </Image>
                    <Grid>
                        <Button x:Name="FavorButton" Width="30" Height="30"
                                Margin="15,10,15,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                                PreviewMouseLeftButtonDown="FavorButton_OnPreviewMouseLeftButtonDown"
                                Style="{DynamicResource MaterialDesignToolButton}"
                                Visibility="{Binding Path=IsLiked, Converter={StaticResource VisibleIfFalseConverter}}">
                            <Viewbox Width="24" Height="24">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z" Fill="Gray" />
                                </Canvas>
                            </Viewbox>
                        </Button>
                        <Button x:Name="DisfavorButton" Width="30" Height="30"
                                Margin="15,10,15,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                                PreviewMouseLeftButtonDown="DisfavorButton_OnPreviewMouseLeftButtonDown"
                                Style="{DynamicResource MaterialDesignToolButton}"
                                Visibility="{Binding Path=IsLiked, Converter={StaticResource VisibleIfTrueConverter}}">
                            <Viewbox Width="24" Height="24">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z" Fill="Crimson" />
                                </Canvas>
                            </Viewbox>
                        </Button>
                    </Grid>
                    <Grid Width="30" Height="30" Margin="0,15,15,0"
                          HorizontalAlignment="Right" VerticalAlignment="Top"
                          Visibility="{Binding Converter={StaticResource IllustSubscriptConverter}}">
                        <Viewbox Width="24" Height="24" HorizontalAlignment="Center"
                                 VerticalAlignment="Center"
                                 ToolTip="{x:Static i18N:AkaI18N.GifIllustrationHint}"
                                 Visibility="{Binding IsUgoira, Converter={StaticResource VisibleIfTrueConverter}}">
                            <Canvas Width="24" Height="24">
                                <Path Data="M11,8H13V16H11V8M7.67,8H4.33C3.53,8 3,8.67 3,9.33V14.67C3,15.33 3.53,16 4.33,16H7.67C8.47,16 9,15.33 9,14.67V12H7V14H5V10H9V9.33C9,8.67 8.47,8 7.67,8M21,10V8H15V16H17V14H19.5V12H17V10H21Z" Fill="Gray" />
                            </Canvas>
                        </Viewbox>
                        <Viewbox Width="24" Height="24" HorizontalAlignment="Center"
                                 VerticalAlignment="Center"
                                 Visibility="{Binding IsManga, Converter={StaticResource VisibleIfTrueConverter}}">
                            <ToolTipService.ToolTip>
                                <TextBlock Text="{Binding MangaMetadata.Length, StringFormat={x:Static i18N:AkaI18N.MangaIllustrationHintFormat}}" />
                            </ToolTipService.ToolTip>
                            <Canvas Width="24" Height="24">
                                <Path Data="M22,16V4A2,2 0 0,0 20,2H8A2,2 0 0,0 6,4V16A2,2 0 0,0 8,18H20A2,2 0 0,0 22,16M11,12L13.03,14.71L16,11L20,16H8M2,6V20A2,2 0 0,0 4,22H18V20H4V6" Fill="Gray" />
                            </Canvas>
                        </Viewbox>
                    </Grid>
                    <Grid x:Name="QualifiedMask" Background="Black" Opacity="0.8">
                        <Grid.Visibility>
                            <MultiBinding Converter="{StaticResource IllustrationMatchConditionMaskConverter}">
                                <Binding Mode="OneWay" Path="Condition"
                                         Source="{x:Static viewModel:ConditionString.Shared}" />
                                <Binding />
                            </MultiBinding>
                        </Grid.Visibility>
                    </Grid>
                </Grid>
            </materialDesign:Card>
        </DataTemplate>
        <DataTemplate x:Key="SpotlightDataTemplate" DataType="viewModel:SpotlightArticle">
            <DataTemplate.Resources>
                <system:Double x:Key="MinusPrecision">
                    -45
                </system:Double>
            </DataTemplate.Resources>
            <Grid x:Name="SpotlightContainer"
                  Width="{Binding ElementName=SpotlightListView, Path=ActualWidth, Converter={StaticResource DoublePlusConverter}, ConverterParameter={StaticResource MinusPrecision}}"
                  Height="300" HorizontalAlignment="Stretch" Cursor="Hand"
                  MouseLeftButtonDown="SpotlightContainer_OnMouseLeftButtonDown">
                <Grid.ContextMenu>
                    <ContextMenu>
                        <MenuItem x:Name="DownloadSpotlightItem" Click="DownloadSpotlightItem_OnClick"
                                  Header="{x:Static i18N:AkaI18N.DownloadSpotlight}" />
                    </ContextMenu>
                </Grid.ContextMenu>
                <Grid.Triggers>
                    <EventTrigger RoutedEvent="ListViewItem.MouseEnter">
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(ScaleTransform.ScaleX)" TargetName="SpotlightScaleTransform">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="1" To="1.2" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(ScaleTransform.ScaleY)" TargetName="SpotlightScaleTransform">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="1" To="1.2" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(BlurEffect.Radius)" TargetName="SpotlightBlurEffect">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="1" To="80" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(Grid.Opacity)" TargetName="SpotlightMask">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="0" To="0.4" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(TextBlock.Opacity)" TargetName="SpotlightTitle">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="0" To="1" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                    <EventTrigger RoutedEvent="ListViewItem.MouseLeave">
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(ScaleTransform.ScaleX)" TargetName="SpotlightScaleTransform">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="1.2" To="1" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(ScaleTransform.ScaleY)" TargetName="SpotlightScaleTransform">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="1.2" To="1" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(BlurEffect.Radius)" TargetName="SpotlightBlurEffect">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="80" To="1" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(Grid.Opacity)" TargetName="SpotlightMask">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="0.4" To="0" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                        <BeginStoryboard>
                            <Storyboard TargetProperty="(TextBlock.Opacity)" TargetName="SpotlightTitle">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="1" To="0" Duration="00:00:00.3" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Grid.Triggers>
                <Image x:Name="SpotlightThumbnail"
                       MaxWidth="{Binding ElementName=SpotlightListView, Path=ActualWidth}"
                       HorizontalAlignment="Stretch" VerticalAlignment="Center" Loaded="SpotlightThumbnail_OnLoaded"
                       RenderTransformOrigin="0.5 0.5" Stretch="UniformToFill"
                       Style="{StaticResource ReleaseImageStyle}">
                    <Image.Effect>
                        <BlurEffect x:Name="SpotlightBlurEffect" KernelType="Gaussian" Radius="1" />
                    </Image.Effect>
                    <Image.RenderTransform>
                        <ScaleTransform x:Name="SpotlightScaleTransform" />
                    </Image.RenderTransform>
                </Image>
                <Grid x:Name="SpotlightMask"
                      MaxWidth="{Binding ElementName=SpotlightListView, Path=ActualWidth}"
                      HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Black"
                      Opacity="0" />
                <TextBlock x:Name="SpotlightTitle" Margin="80,0,80,0" HorizontalAlignment="Center"
                           VerticalAlignment="Center" FontFamily="YouYuan" FontSize="55"
                           Foreground="#FFB6B6B6" LineHeight="80" Opacity="0"
                           Text="{Binding Title}"
                           TextAlignment="Center" TextWrapping="Wrap" />
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="UserPreviewTemplate" DataType="viewModel:User">
            <materialDesign:TransitioningContent>
                <materialDesign:TransitioningContent.OpeningEffects>
                    <materialDesign:TransitionEffect Kind="FadeIn" />
                </materialDesign:TransitioningContent.OpeningEffects>
                <materialDesign:Card x:Name="UserPrevItem"
                                     Width="{Binding ElementName=UserPreviewListView, Path=ActualWidth}"
                                     Height="180" Margin="10" materialDesign:ShadowAssist.ShadowDepth="Depth2"
                                     Background="White" Cursor="Hand" Loaded="UserPrevItem_OnLoaded"
                                     MouseLeftButtonDown="UserPrevItem_OnMouseLeftButtonDown">
                    <materialDesign:Card.Triggers>
                        <EventTrigger RoutedEvent="materialDesign:Card.MouseLeftButtonDown">
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}" TargetProperty="(ScrollViewer.Opacity)">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="0" To="1" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}" TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="0" To="1" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}" TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="0" To="1" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=ContentContainer}" TargetProperty="(Grid.Opacity)">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="1" To="0" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=ContentContainer}" TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="1" To="0" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                            <BeginStoryboard>
                                <Storyboard Target="{Binding ElementName=ContentContainer}" TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)">
                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                     From="1" To="0" Duration="00:00:00.3" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </materialDesign:Card.Triggers>
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <StackPanel HorizontalAlignment="Left" Grid.ZIndex="1" Orientation="Horizontal">
                            <StackPanel.Background>
                                <LinearGradientBrush StartPoint="0 0" EndPoint="1 0">
                                    <GradientStop Offset="0" Color="White" />
                                    <GradientStop Offset="0.85" Color="White" />
                                    <GradientStop Offset="1" Color="Transparent" />
                                </LinearGradientBrush>
                            </StackPanel.Background>
                            <Image x:Name="UserAvatar" Width="150" Height="150"
                                   Margin="50,0,0,0" VerticalAlignment="Center" Stretch="UniformToFill"
                                   Style="{StaticResource ReleaseImageStyle}">
                                <Image.Clip>
                                    <EllipseGeometry Center="75 75" RadiusX="75" RadiusY="75" />
                                </Image.Clip>
                            </Image>
                            <StackPanel Width="330" Margin="20,30,0,30" Orientation="Vertical">
                                <TextBlock Margin="0,20,0,0" FontSize="25"
                                           Text="{Binding Name}"
                                           TextWrapping="Wrap" />
                                <TextBlock Margin="15,25,0,0" FontSize="20"
                                           Text="{Binding Id, StringFormat={x:Static i18N:AkaI18N.UserIdHintFormat}}" />
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Width="660" Margin="0,0,50,0" HorizontalAlignment="Right"
                                    VerticalAlignment="Center" Grid.ZIndex="0" Orientation="Horizontal">
                            <materialDesign:Card Margin="10,5" UniformCornerRadius="10">
                                <Image Width="200" Height="160" HorizontalAlignment="Center"
                                       VerticalAlignment="Center" Stretch="UniformToFill"
                                       Style="{StaticResource ReleaseImageStyle}" />
                            </materialDesign:Card>
                            <materialDesign:Card Margin="10,5" UniformCornerRadius="10">
                                <Image Width="200" Height="160" HorizontalAlignment="Center"
                                       VerticalAlignment="Center" Stretch="UniformToFill"
                                       Style="{StaticResource ReleaseImageStyle}" />
                            </materialDesign:Card>
                            <materialDesign:Card Margin="10,5" UniformCornerRadius="10">
                                <Image Width="200" Height="160" HorizontalAlignment="Center"
                                       VerticalAlignment="Center" Stretch="UniformToFill"
                                       Style="{StaticResource ReleaseImageStyle}" />
                            </materialDesign:Card>
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>
            </materialDesign:TransitioningContent>
        </DataTemplate>
    </Window.Resources>
    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <Grid x:Name="ContentContainer" Grid.ColumnSpan="2">
            <Grid.RenderTransform>
                <ScaleTransform CenterX="{Binding ElementName=ContentContainer, Path=ActualWidth, Converter={StaticResource DoubleDivisionConverter}, ConverterParameter={StaticResource Divide}}" CenterY="{Binding ElementName=ContentContainer, Path=ActualHeight, Converter={StaticResource DoubleDivisionConverter}, ConverterParameter={StaticResource Divide}}" ScaleX="1" ScaleY="1" />
            </Grid.RenderTransform>
            <Grid x:Name="NavigatorContainer" Width="250" HorizontalAlignment="Left"
                  VerticalAlignment="Stretch">
                <materialDesign:Card x:Name="NavigatorCard" Width="250" HorizontalAlignment="Left"
                                     VerticalAlignment="Stretch">
                    <ScrollViewer x:Name="NavigatorScrollViewer" HorizontalScrollBarVisibility="Disabled" PreviewMouseWheel="NavigatorScrollViewer_OnPreviewMouseWheel"
                                  VerticalScrollBarVisibility="Auto">
                        <Grid>
                            <StackPanel x:Name="NavigatorWrapper" Height="800" Margin="0,0,0,60"
                                        VerticalAlignment="Top">
                                <Grid x:Name="UserInformation" Margin="0,40,0,0">
                                    <Image x:Name="UserAvatar" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                        <Image.Style>
                                            <Style TargetType="Image">
                                                <Setter Property="Width" Value="120" />
                                                <Setter Property="Height" Value="120" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ElementName=ExpandToggleButton, Path=IsChecked}" Value="False">
                                                        <Setter Property="RenderTransform">
                                                            <Setter.Value>
                                                                <RotateTransform Angle="0" CenterX="35" CenterY="35" />
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding ElementName=ExpandToggleButton, Path=IsChecked}" Value="True">
                                                        <Setter Property="RenderTransform">
                                                            <Setter.Value>
                                                                <RotateTransform Angle="0" CenterX="60" CenterY="60" />
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Image.Style>
                                        <Image.Triggers>
                                            <EventTrigger RoutedEvent="Mouse.MouseEnter">
                                                <BeginStoryboard>
                                                    <Storyboard TargetProperty="(Image.RenderTransform).(RotateTransform.Angle)" TargetName="UserAvatar">
                                                        <DoubleAnimation x:Name="UserAvatarPositiveRotationAnimation"
                                                                         EasingFunction="{StaticResource CubicEase}"
                                                                         From="0" To="360" Duration="00:00:01" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger>
                                            <EventTrigger RoutedEvent="Mouse.MouseLeave">
                                                <BeginStoryboard>
                                                    <Storyboard TargetProperty="(Image.RenderTransform).(RotateTransform.Angle)" TargetName="UserAvatar">
                                                        <DoubleAnimation x:Name="UserAvatarNegativeRotationAnimation"
                                                                         EasingFunction="{StaticResource CubicEase}"
                                                                         From="360" To="0" Duration="00:00:01" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger>
                                        </Image.Triggers>
                                        <Image.Clip>
                                            <EllipseGeometry x:Name="AvatarEllipseGeometry" Center="60 60" RadiusX="60"
                                                             RadiusY="60" />
                                        </Image.Clip>
                                    </Image>
                                    <TextBlock x:Name="UserName" Height="60" Margin="5,125,5,0"
                                               VerticalAlignment="Center" FontSize="18" TextAlignment="Center"
                                               TextWrapping="NoWrap" />
                                </Grid>
                                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                    <ListView x:Name="NavigatorList" KeyDown="NavigatorList_OnKeyDown" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                              SelectionChanged="NavigatorList_OnSelectionChanged"
                                              Style="{DynamicResource MaterialDesignListView}">
                                        <ListViewItem x:Name="MenuTab" Height="45">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe608;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.HomePage}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="GalleryTab" Height="45" Selected="GalleryTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe628;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.MyGallery}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="FollowingTab" Height="45" Selected="FollowingTab_OnSelected"
                                                      Unselected="FollowingTab_OnUnselected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe604;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.MyFollowing}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="SpotlightTab" Height="45" Selected="SpotlightTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe659;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.Spotlight}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem Height="45" Selected="RecommendTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe6ad;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.Recommend}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="RankingTab" Height="45" Selected="RankingTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe645;" TextElement.FontFamily="/Resources/#dqueue" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.IllustRanking}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="TrendsTab" Height="45" Selected="TrendsTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe728;" TextElement.FontFamily="/Resources/#dqueue" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.UserTrend}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem Height="45" Selected="UpdateIllustTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe60d;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.UserUpdate}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="SauceNaoTab" Height="45">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe60a;" TextElement.FontFamily="/Resources/#dqueue" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.SearchImageBySource}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                    </ListView>
                                    <Separator x:Name="Separator" Width="230" Height="1"
                                               Margin="10,10,0,10" HorizontalAlignment="Left" VerticalAlignment="Top" />
                                    <ListView x:Name="ExternalNavigatorList" KeyDown="ExternalNavigatorList_OnKeyDown" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                              Style="{DynamicResource MaterialDesignListView}">
                                        <ListViewItem x:Name="DownloadListTab" Height="45" HorizontalAlignment="Stretch"
                                                      Selected="DownloadListTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe64b;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.DownloadQueueAndHistory}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="SettingsTab" Height="45" HorizontalAlignment="Stretch"
                                                      Selected="SettingsTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe643;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.Setting}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                        <ListViewItem x:Name="SignOutTab" Height="45" HorizontalAlignment="Stretch"
                                                      Selected="SignOutTab_OnSelected">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Margin="30,0,0,0" VerticalAlignment="Center" FontSize="20"
                                                           Text="&#xe6ce;" TextElement.FontFamily="/Resources/#iconfont" />
                                                <Label Margin="30,0,0,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                                       Content="{x:Static i18N:AkaI18N.Logout}"
                                                       FontSize="14" FontWeight="Bold" />
                                            </StackPanel>
                                        </ListViewItem>
                                    </ListView>
                                </StackPanel>
                            </StackPanel>
                            <ToggleButton x:Name="ExpandToggleButton" Width="25" Height="25"
                                          Margin="30,0,0,23" HorizontalAlignment="Left" VerticalAlignment="Bottom"
                                          Foreground="Gray" IsChecked="True"
                                          Style="{DynamicResource MaterialDesignHamburgerToggleButton}"
                                          ToolTip="{x:Static i18N:AkaI18N.RetractSidebar}">
                                <ToggleButton.Triggers>
                                    <EventTrigger RoutedEvent="ToggleButton.Unchecked">
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Grid.Margin)" TargetName="ContentDisplay">
                                                <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                    From="250 0 0 0" To="90 0 0 0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(materialDesign:Card.Width)" TargetName="NavigatorCard">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="250" To="90" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Grid.Width)" TargetName="NavigatorContainer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="250" To="90" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Separator.Width)" TargetName="Separator">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="230" To="70" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Image.Width)" TargetName="UserAvatar">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="120" To="70" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(EllipseGeometry.RadiusX)" TargetName="AvatarEllipseGeometry">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="60" To="35" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(EllipseGeometry.RadiusY)" TargetName="AvatarEllipseGeometry">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="60" To="35" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(EllipseGeometry.Center)" TargetName="AvatarEllipseGeometry">
                                                <PointAnimation EasingFunction="{StaticResource CubicEase}"
                                                                From="60 60" To="35 35" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(TextBlock.Opacity)" TargetName="UserName">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="1" To="0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(TextBlock.Margin)" TargetName="UserName">
                                                <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                    From="5 125 5 0" To="5 35 5 0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <EventTrigger RoutedEvent="ToggleButton.Checked">
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Grid.Margin)" TargetName="ContentDisplay">
                                                <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                    From="90 0 0 0" To="250 0 0 0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(materialDesign:Card.Width)" TargetName="NavigatorCard">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="90" To="250" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Grid.Width)" TargetName="NavigatorContainer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="90" To="250" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Separator.Width)" TargetName="Separator">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="70" To="230" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Image.Width)" TargetName="UserAvatar">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="70" To="120" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(EllipseGeometry.RadiusX)" TargetName="AvatarEllipseGeometry">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="35" To="60" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(EllipseGeometry.RadiusY)" TargetName="AvatarEllipseGeometry">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="35" To="60" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(EllipseGeometry.Center)" TargetName="AvatarEllipseGeometry">
                                                <PointAnimation EasingFunction="{StaticResource CubicEase}"
                                                                From="35 35" To=" 60 60" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(TextBlock.Opacity)" TargetName="UserName">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="0" To="1" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(TextBlock.Margin)" TargetName="UserName">
                                                <ThicknessAnimation EasingFunction="{StaticResource CubicEase}"
                                                                    From="5 35 5 0" To="5 125 5 0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </ToggleButton.Triggers>
                            </ToggleButton>
                        </Grid>
                    </ScrollViewer>
                </materialDesign:Card>
            </Grid>
            <Grid x:Name="ContentDisplay" Margin="250,0,0,0" MouseMove="ContentDisplay_OnMouseMove">
                <Grid x:Name="RestrictPolicySelector" Height="60" VerticalAlignment="Top"
                      ZIndex="3">
                    <Grid.RenderTransform>
                        <TranslateTransform X="0" Y="-60" />
                    </Grid.RenderTransform>
                    <materialDesign:Card Height="40" VerticalAlignment="Top">
                        <StackPanel Margin="80,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center"
                                    Orientation="Horizontal">
                            <TextBlock FontFamily="Microsoft YaHei Light" FontSize="12"
                                       Text="{Binding Source={x:Static i18N:AkaI18N.RestrictPolicy}, StringFormat={}{0}:}" />
                            <RadioButton x:Name="PublicRestrictPolicy" Margin="20,0,0,0" Background="#66CCFF"
                                         Checked="PublicRestrictPolicy_OnChecked"
                                         Content="{x:Static i18N:AkaI18N.Public}"
                                         IsChecked="True"
                                         Style="{DynamicResource MaterialDesignRadioButton}" />
                            <RadioButton x:Name="PrivateRestrictPolicy" Margin="20,0,0,0" Background="#66CCFF"
                                         Checked="PrivateRestrictPolicy_OnChecked"
                                         Content="{x:Static i18N:AkaI18N.Private}"
                                         Style="{DynamicResource MaterialDesignRadioButton}" />
                        </StackPanel>
                    </materialDesign:Card>
                </Grid>
                <ScrollViewer x:Name="RankOptionSelector" Height="60" VerticalAlignment="Top"
                              materialDesign:ScrollBarAssist.ThumbHeight="10" Grid.ZIndex="3" HorizontalScrollBarVisibility="Auto"
                              VerticalScrollBarVisibility="Disabled">
                    <ScrollViewer.RenderTransform>
                        <TranslateTransform X="0" Y="-60" />
                    </ScrollViewer.RenderTransform>
                    <materialDesign:Card Height="40" MinWidth="1300" VerticalAlignment="Top">
                        <materialDesign:Card.Resources>
                            <ResourceDictionary>
                                <ResourceDictionary.MergedDictionaries>
                                    <ResourceDictionary Source="pack://application:,,,/Dragablz;component/Themes/materialdesign.xaml" />
                                    <ResourceDictionary>
                                        <SolidColorBrush x:Key="PrimaryHueLightBrush" Color="#FFFFFF" />
                                        <SolidColorBrush x:Key="PrimaryHueLightForegroundBrush" Color="#FFFFFF" />
                                        <SolidColorBrush x:Key="PrimaryHueMidBrush" Color="#FFFFFF" />
                                        <SolidColorBrush x:Key="PrimaryHueMidForegroundBrush" Color="#FFFFFF" />
                                        <SolidColorBrush x:Key="PrimaryHueDarkBrush" Color="#FFFFFF" />
                                        <SolidColorBrush x:Key="PrimaryHueDarkForegroundBrush" Color="#FFFFFF" />
                                    </ResourceDictionary>
                                    <ResourceDictionary>
                                        <SolidColorBrush x:Key="SecondaryAccentBrush" Color="#007CEE" />
                                        <SolidColorBrush x:Key="SecondaryAccentForegroundBrush" Color="#007CEE" />
                                    </ResourceDictionary>
                                </ResourceDictionary.MergedDictionaries>
                                <Style BasedOn="{StaticResource MaterialDesignTabablzControlStyle}" TargetType="{x:Type dragablz:TabablzControl}" />
                            </ResourceDictionary>
                        </materialDesign:Card.Resources>
                        <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                            <DatePicker x:Name="RankDatePicker" Width="80" VerticalAlignment="Center"
                                        FontSize="12"
                                        SelectedDate="{x:Static viewModel:RankOptionModel.MaxRankDateTime}"
                                        SelectedDateChanged="RankDatePicker_OnSelectedDateChanged">
                                <DatePicker.BlackoutDates>
                                    <CalendarDateRange End="{x:Static system:DateTime.MaxValue}" Start="{x:Static viewModel:RankOptionModel.InvalidRankDateTimeStart}" />
                                </DatePicker.BlackoutDates>
                                <DatePicker.Resources>
                                    <ResourceDictionary>
                                        <ResourceDictionary.MergedDictionaries>
                                            <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Light.xaml" />
                                            <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />
                                            <ResourceDictionary Source="pack://application:,,,/MaterialDesignColors;component/Themes/Recommended/Primary/MaterialDesignColor.Blue.xaml" />
                                            <ResourceDictionary Source="pack://application:,,,/MaterialDesignColors;component/Themes/Recommended/Accent/MaterialDesignColor.Purple.xaml" />
                                        </ResourceDictionary.MergedDictionaries>
                                        <Style TargetType="DatePickerTextBox">
                                            <Setter Property="IsReadOnly" Value="True" />
                                            <Setter Property="VerticalContentAlignment" Value="Bottom" />
                                        </Style>
                                    </ResourceDictionary>
                                </DatePicker.Resources>
                            </DatePicker>
                            <dragablz:TabablzControl x:Name="RankOptionPicker" Height="40" Margin="10,0,0,0"
                                                     BorderThickness="0"
                                                     DataContext="{x:Static viewModel:RankOptionModel.RegularRankOptions}"
                                                     HeaderMemberPath="Name" SelectionChanged="RankOptionPicker_OnSelectionChanged" TextElement.FontFamily="Microsoft YaHei Light"
                                                     TextElement.FontSize="10">
                                <TabItem IsSelected="{Binding Path=[0].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[0].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[1].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[1].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[2].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[2].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[3].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[3].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[4].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[4].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[5].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[5].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[6].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[6].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[7].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[7].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[8].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[8].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[9].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[9].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[10].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[10].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[11].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[11].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[12].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[12].Name}" />
                                    </TabItem.Header>
                                </TabItem>
                                <TabItem IsSelected="{Binding Path=[13].IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <TabItem.Header>
                                        <TextBlock Text="{Binding Path=[13].Name}" />
                                    </TabItem.Header>
                                </TabItem>

                            </dragablz:TabablzControl>
                        </StackPanel>
                    </materialDesign:Card>
                </ScrollViewer>
                <Grid>
                    <Grid x:Name="HomeDisplayContainer" ZIndex="1">
                        <Grid.RenderTransform>
                            <TranslateTransform Y="0" />
                        </Grid.RenderTransform>
                        <Grid.Resources>
                            <Storyboard x:Key="MoveUpAnimation" TargetProperty="(Grid.RenderTransform).(TranslateTransform.Y)" TargetName="HomeDisplayContainer">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="{Binding ElementName=ContentDisplay, Path=ActualHeight}"
                                                 To="0" Duration="00:00:00.3" />
                            </Storyboard>
                            <Storyboard x:Key="MoveDownAnimation" TargetProperty="(Grid.RenderTransform).(TranslateTransform.Y)" TargetName="HomeDisplayContainer">
                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                 From="0" To="5000" Duration="00:00:01.50" />
                            </Storyboard>
                        </Grid.Resources>
                        <ScrollViewer HorizontalScrollBarVisibility="Auto">
                            <Grid MinWidth="1110" Background="#FAFAFC">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <svgc:SvgViewbox Grid.Row="0" Width="100" Height="100"
                                                 Margin="0,0,0,20" VerticalAlignment="Bottom" Source="/Resources/logo-only.svg">
                                    <svgc:SvgViewbox.Triggers>
                                        <EventTrigger RoutedEvent="Mouse.MouseEnter">
                                            <BeginStoryboard>
                                                <Storyboard TargetProperty="(RotateTransform.Angle)" TargetName="PixivLogoTransform">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="0" To="360" Duration="00:00:01" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                        <EventTrigger RoutedEvent="Mouse.MouseLeave">
                                            <BeginStoryboard>
                                                <Storyboard TargetProperty="(RotateTransform.Angle)" TargetName="PixivLogoTransform">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="360" To="0" Duration="00:00:01" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </svgc:SvgViewbox.Triggers>
                                    <svgc:SvgViewbox.RenderTransform>
                                        <RotateTransform x:Name="PixivLogoTransform" Angle="0" CenterX="50" CenterY="50" />
                                    </svgc:SvgViewbox.RenderTransform>
                                    <svgc:SvgViewbox.Clip>
                                        <EllipseGeometry Center="50 50" RadiusX="50" RadiusY="50" />
                                    </svgc:SvgViewbox.Clip>
                                </svgc:SvgViewbox>
                                <StackPanel Grid.Row="1" Height="50" Margin="0,20,0,0"
                                            HorizontalAlignment="Center" VerticalAlignment="Top" Orientation="Horizontal">
                                    <TextBox x:Name="KeywordTextBox" Width="800"
                                             materialDesign:HintAssist.Hint="{x:Static i18N:AkaI18N.SearchHint}"
                                             GotFocus="KeywordTextBox_OnGotFocus" PreviewKeyDown="KeywordTextBox_OnPreviewKeyDown"
                                             Style="{DynamicResource MaterialDesignFloatingHintTextBox}"
                                             TextChanged="KeywordTextBox_OnTextChanged" />
                                    <TextBox x:Name="ToLoseFocus" Width="0" Height="0" />
                                    <Button x:Name="DoQueryButton" Width="50" Height="40"
                                            Margin="10,15,0,0" Click="DoQueryButton_OnClick" IsDefault="False"
                                            Style="{DynamicResource MaterialDesignToolButton}">
                                        <Viewbox Width="34" Height="30">
                                            <Canvas Width="24" Height="24">
                                                <Path Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" Fill="Black" Opacity="0.6" />
                                            </Canvas>
                                        </Viewbox>
                                    </Button>
                                </StackPanel>
                                <Popup x:Name="TrendingTagPopup" Grid.Row="1" Width="800"
                                       primitive:PopupHelper.PopupPlacementTarget="{Binding ElementName=KeywordTextBox}"
                                       AllowsTransparency="True" Placement="Bottom"
                                       PlacementTarget="{Binding ElementName=KeywordTextBox}"
                                       StaysOpen="True">
                                    <materialDesign:Card Background="#FAFAFC" UniformCornerRadius="10">
                                        <StackPanel>
                                            <StackPanel Height="40" HorizontalAlignment="Center" Orientation="Horizontal">
                                                <ToggleButton x:Name="QueryArtistToggleButton" Width="30" Height="30"
                                                              Margin="0,0,5,0" Checked="QueryArtistToggleButton_OnChecked"
                                                              Style="{DynamicResource MaterialDesignFlatToggleButton}"
                                                              ToolTip="{x:Static i18N:AkaI18N.QueryUser}"
                                                              Unchecked="QueryArtistToggleButton_OnUnchecked">
                                                    <Viewbox Width="24" Height="24">
                                                        <Canvas Width="24" Height="24">
                                                            <Path Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" Fill="Gray" />
                                                        </Canvas>
                                                    </Viewbox>
                                                </ToggleButton>
                                                <ToggleButton x:Name="QuerySingleArtistToggleButton" Width="30" Height="30"
                                                              Margin="5,0,5,0" Checked="QuerySingleArtistToggleButton_OnChecked"
                                                              Style="{DynamicResource MaterialDesignFlatToggleButton}"
                                                              ToolTip="{x:Static i18N:AkaI18N.QuerySingleUser}">
                                                    <Viewbox Width="24" Height="24">
                                                        <Canvas Width="24" Height="24">
                                                            <Path Data="M19,21V19H15V17H19V15L22,18L19,21M10,4A4,4 0 0,1 14,8A4,4 0 0,1 10,12A4,4 0 0,1 6,8A4,4 0 0,1 10,4M10,14C11.15,14 12.25,14.12 13.24,14.34C12.46,15.35 12,16.62 12,18C12,18.7 12.12,19.37 12.34,20H2V18C2,15.79 5.58,14 10,14Z" Fill="Gray" />
                                                        </Canvas>
                                                    </Viewbox>
                                                </ToggleButton>
                                                <ToggleButton x:Name="QuerySingleWorkToggleButton" Width="30" Height="30"
                                                              Margin="5,0,0,0" Checked="QuerySingleWorkToggleButton_OnChecked"
                                                              Style="{DynamicResource MaterialDesignFlatToggleButton}"
                                                              ToolTip="{x:Static i18N:AkaI18N.QuerySingleIllust}">
                                                    <Viewbox Width="24" Height="24">
                                                        <Canvas Width="24" Height="24">
                                                            <Path Data="M10,7V9H12V17H14V7H10M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z" Fill="Gray" />
                                                        </Canvas>
                                                    </Viewbox>
                                                </ToggleButton>
                                            </StackPanel>
                                            <userControls:TrendingTagControl />
                                        </StackPanel>
                                    </materialDesign:Card>
                                </Popup>
                                <Popup x:Name="AutoCompletionPopup" Grid.Row="1" Width="800"
                                       primitive:PopupHelper.PopupPlacementTarget="{Binding ElementName=KeywordTextBox}"
                                       AllowsTransparency="True" Placement="Bottom"
                                       PlacementTarget="{Binding ElementName=KeywordTextBox}"
                                       StaysOpen="False">
                                    <materialDesign:Card Width="800" Background="#FAFAFC" UniformCornerRadius="15">
                                        <ListBox x:Name="AutoCompletionListBox" Width="800" MaxHeight="400"
                                                 ScrollViewer.CanContentScroll="False">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate DataType="viewModel:AutoCompletion">
                                                    <ListBoxItem x:Name="AutoCompletionElement"
                                                                 Width="{Binding ElementName=AutoCompletionListBox, Path=Width}"
                                                                 HorizontalAlignment="Stretch" PreviewMouseLeftButtonDown="AutoCompletionElement_OnPreviewMouseLeftButtonDown">
                                                        <StackPanel HorizontalAlignment="Stretch">
                                                            <TextBlock Margin="0,0,0,5" HorizontalAlignment="Left" FontSize="12"
                                                                       Text="{Binding Tag}"
                                                                       TextTrimming="WordEllipsis" TextWrapping="NoWrap" />
                                                            <TextBlock HorizontalAlignment="Left" FontSize="10"
                                                                       Text="{Binding TranslatedName}"
                                                                       TextTrimming="WordEllipsis" TextWrapping="NoWrap" />
                                                        </StackPanel>
                                                    </ListBoxItem>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </materialDesign:Card>
                                </Popup>
                                <Grid Grid.Row="2">
                                    <StackPanel Height="120" HorizontalAlignment="Center" FlowDirection="LeftToRight"
                                                Orientation="Horizontal"
                                                Visibility="{Binding Source={x:Static persisting:Settings.Global}, Path=RecommendIllustrator, Converter={StaticResource VisibleIfTrueConverter}}">
                                        <ListBox x:Name="RecommendIllustratorListBox">
                                            <ListBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <VirtualizingStackPanel CanHorizontallyScroll="False" CanVerticallyScroll="False" FlowDirection="LeftToRight"
                                                                            IsItemsHost="True" Orientation="Horizontal" />
                                                </ItemsPanelTemplate>
                                            </ListBox.ItemsPanel>
                                            <ListBox.ItemTemplate>
                                                <DataTemplate DataType="viewModel:User">
                                                    <materialDesign:TransitioningContent>
                                                        <materialDesign:TransitioningContent.OpeningEffects>
                                                            <materialDesign:TransitionEffect Kind="FadeIn" />
                                                        </materialDesign:TransitioningContent.OpeningEffects>
                                                        <Grid x:Name="RecommendIllustratorContainer" MouseLeftButtonDown="RecommendIllustratorContainer_OnMouseLeftButtonDown">
                                                            <materialDesign:Card Width="120" Height="100" Margin="5,0"
                                                                                 UniformCornerRadius="10">
                                                                <StackPanel Margin="10,15,10,0">
                                                                    <Image x:Name="RecommendIllustratorAvatar" Width="40" Height="40"
                                                                           Loaded="RecommendIllustratorAvatar_OnLoaded">
                                                                        <Image.Clip>
                                                                            <EllipseGeometry Center="20 20" RadiusX="20" RadiusY="20" />
                                                                        </Image.Clip>
                                                                    </Image>
                                                                    <TextBlock Margin="0,15,0,0" HorizontalAlignment="Center" FontSize="13"
                                                                               Text="{Binding Name}"
                                                                               TextTrimming="CharacterEllipsis" />
                                                                </StackPanel>
                                                            </materialDesign:Card>
                                                            <Popup Width="480" Height="160" HorizontalAlignment="Center"
                                                                   primitive:PopupHelper.PopupPlacementTarget="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}}}"
                                                                   AllowsTransparency="True" HorizontalOffset="-180"
                                                                   IsOpen="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}}, Path=IsMouseOver, Mode=OneWay}"
                                                                   Placement="Top"
                                                                   PlacementTarget="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}}}"
                                                                   PopupAnimation="Fade" StaysOpen="True">
                                                                <Grid>
                                                                    <materialDesign:Card Margin="5" UniformCornerRadius="15">
                                                                        <StackPanel x:Name="IllustratorIllustsStackPanel" Loaded="IllustratorIllustsStackPanel_OnLoaded" Orientation="Horizontal">
                                                                            <Image Width="160" Height="160" Stretch="UniformToFill" />
                                                                            <Image Width="160" Height="160" Stretch="UniformToFill" />
                                                                            <Image Width="160" Height="160" Stretch="UniformToFill" />
                                                                        </StackPanel>
                                                                    </materialDesign:Card>
                                                                </Grid>
                                                            </Popup>
                                                        </Grid>
                                                    </materialDesign:TransitioningContent>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                        <Grid Width="25" Margin="20,0,0,0">
                                            <Grid.Triggers>
                                                <EventTrigger RoutedEvent="Grid.MouseEnter">
                                                    <BeginStoryboard>
                                                        <Storyboard TargetProperty="(Grid.Opacity)" TargetName="ReloadRecommendIllustratorButton">
                                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                             From="0" To="1" Duration="00:00:00.3" />
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </EventTrigger>
                                                <EventTrigger RoutedEvent="Grid.MouseLeave">
                                                    <BeginStoryboard>
                                                        <Storyboard TargetProperty="(Grid.Opacity)" TargetName="ReloadRecommendIllustratorButton">
                                                            <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                             From="1" To="0" Duration="00:00:00.3" />
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </EventTrigger>
                                            </Grid.Triggers>
                                            <TextBlock x:Name="ReloadRecommendIllustratorButton" VerticalAlignment="Center" Cursor="Hand"
                                                       FontFamily="/Resources/#iconfontex" FontSize="25" MouseLeftButtonDown="ReloadRecommendIllustratorButton_OnMouseLeftButtonDown"
                                                       Opacity="0" Text="&#xe696;"
                                                       ToolTip="{x:Static i18N:AkaI18N.RecommendIllustratorTurnPage}" />
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                                <StackPanel Grid.Row="2" Margin="0,0,10,10" HorizontalAlignment="Right"
                                            VerticalAlignment="Bottom" Orientation="Horizontal">
                                    <TextBlock Margin="0,0,10,0" FontSize="12"
                                               Text="{Binding Source={x:Static pixeval:AppContext.CurrentVersion}, StringFormat={x:Static i18N:AkaI18N.PixevalVersionFormat}}" />
                                    <TextBlock Margin="0,0,10,0" FontSize="12">
                                        <Hyperlink Foreground="Black" NavigateUri="http://47.95.218.243/index.html" RequestNavigate="Hyperlink_OnRequestNavigate">
                                            <TextBlock Text="{x:Static i18N:AkaI18N.AboutPixeval}" />
                                        </Hyperlink>
                                    </TextBlock>
                                    <TextBlock FontSize="12">
                                        <Hyperlink Foreground="Black" NavigateUri="https://afdian.net/@dylech30th" RequestNavigate="Hyperlink_OnRequestNavigate">
                                            <TextBlock Text="{x:Static i18N:AkaI18N.SupportMe}" />
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </Grid>
                    <Grid Background="#FAFAFC">
                        <ListView x:Name="TrendsListView"
                                  ItemTemplate="{StaticResource TrendsTemplate}"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled" VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.CacheLengthUnit="Pixel"
                                  VirtualizingPanel.ScrollUnit="Pixel" VirtualizingPanel.VirtualizationMode="Standard"
                                  Visibility="{Binding ElementName=TrendsTab, Path=IsSelected, Converter={StaticResource VisibleIfTrueConverter}}">
                            <ListView.Style>
                                <Style BasedOn="{StaticResource MaterialDesignListView}" TargetType="ListView">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=TrendsTab, Path=IsSelected}" Value="False">
                                            <Setter Property="ItemsSource" Value="{x:Null}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.Style>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <controls:VirtualizingWrapPanel Orientation="Vertical" />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                        </ListView>
                        <ListView x:Name="SpotlightListView"
                                  ItemTemplate="{StaticResource SpotlightDataTemplate}"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled" VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.CacheLengthUnit="Pixel"
                                  VirtualizingPanel.ScrollUnit="Pixel" VirtualizingPanel.VirtualizationMode="Standard"
                                  Visibility="{Binding ElementName=SpotlightTab, Path=IsSelected, Converter={StaticResource VisibleIfTrueConverter}}">
                            <ListView.Style>
                                <Style BasedOn="{StaticResource MaterialDesignListView}" TargetType="ListView">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=SpotlightTab, Path=IsSelected}" Value="False">
                                            <Setter Property="ItemsSource" Value="{x:Null}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.Style>
                            <ListView.Template>
                                <ControlTemplate>
                                    <ScrollViewer VirtualizingStackPanel.IsVirtualizing="True" VirtualizingStackPanel.VirtualizationMode="Recycling">
                                        <ItemsPresenter />
                                    </ScrollViewer>
                                </ControlTemplate>
                            </ListView.Template>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                        </ListView>
                        <ListView x:Name="UserPreviewListView"
                                  ItemTemplate="{StaticResource UserPreviewTemplate}"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled" VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.CacheLengthUnit="Pixel"
                                  VirtualizingPanel.ScrollUnit="Pixel" VirtualizingPanel.VirtualizationMode="Standard">
                            <ListView.Resources>
                                <valueConverters:UserPreviewListViewVisibilityConverter x:Key="UserPreviewListViewVisibilityConverter" />
                            </ListView.Resources>
                            <ListView.Visibility>
                                <MultiBinding Converter="{StaticResource UserPreviewListViewVisibilityConverter}">
                                    <Binding ElementName="SpotlightTab" Path="IsSelected" />
                                    <Binding ElementName="TrendsTab" Path="IsSelected" />
                                    <Binding ElementName="QueryArtistToggleButton" Path="IsChecked" />
                                </MultiBinding>
                            </ListView.Visibility>
                            <ListView.Template>
                                <ControlTemplate>
                                    <ScrollViewer VirtualizingStackPanel.IsVirtualizing="True" VirtualizingStackPanel.VirtualizationMode="Recycling">
                                        <ItemsPresenter />
                                    </ScrollViewer>
                                </ControlTemplate>
                            </ListView.Template>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                        </ListView>
                        <ListView x:Name="ImageListView"
                                  Width="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}, AncestorLevel=1}, Path=Width}"
                                  Grid.ZIndex="1"
                                  ItemTemplate="{StaticResource IllustrationTemplate}"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.IsDeferredScrollingEnabled="True" VirtualizingPanel.CacheLength="0 0"
                                  VirtualizingPanel.CacheLengthUnit="Pixel" VirtualizingPanel.ScrollUnit="Pixel" VirtualizingPanel.VirtualizationMode="Standard">
                            <ListView.Style>
                                <Style BasedOn="{StaticResource MaterialDesignListView}" TargetType="ListView">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=MenuTab, Path=IsSelected}" Value="True">
                                            <Setter Property="ItemsSource" Value="{x:Null}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.Style>
                            <ListView.Resources>
                                <valueConverters:ImageListViewVisibilityConverter x:Key="ImageListViewVisibilityConverter" />
                            </ListView.Resources>
                            <ListView.Visibility>
                                <MultiBinding Converter="{StaticResource ImageListViewVisibilityConverter}">
                                    <Binding ElementName="SpotlightTab" Path="IsSelected" />
                                    <Binding ElementName="FollowingTab" Path="IsSelected" />
                                    <Binding ElementName="QueryArtistToggleButton" Path="IsChecked" />
                                    <Binding ElementName="TrendsTab" Path="IsSelected" />
                                </MultiBinding>
                            </ListView.Visibility>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <controls:VirtualizingWrapPanel Orientation="Vertical" />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                        </ListView>
                        <userControls:InputBoxControl x:Name="ConditionInputBox"
                                                      DataContext="{x:Static viewModel:ConditionString.Shared}"
                                                      Grid.ZIndex="2" Visibility="Hidden" />
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
        <userControls:SauceNAOHomePage Margin="250,0,0,0" Background="#FAFAFC"
                                       Visibility="{Binding ElementName=SauceNaoTab, Path=IsSelected, Converter={StaticResource VisibleIfTrueConverter}}" />
        <Grid>
            <ScrollViewer x:Name="UserBrowserPageScrollViewer" Grid.Column="0" HorizontalScrollBarVisibility="Disabled"
                          MouseLeftButtonDown="UserBrowserPageScrollViewer_OnMouseLeftButtonDown" Opacity="0">
                <ScrollViewer.RenderTransform>
                    <ScaleTransform CenterX="{Binding ElementName=UserBrowserPageScrollViewer, Path=ActualWidth, Converter={StaticResource DoubleDivisionConverter}, ConverterParameter={StaticResource Divide}}" CenterY="{Binding ElementName=UserBrowserPageScrollViewer, Path=ActualHeight, Converter={StaticResource DoubleDivisionConverter}, ConverterParameter={StaticResource Divide}}" ScaleX="0" ScaleY="0" />
                </ScrollViewer.RenderTransform>
                <ScrollViewer.Resources>
                    <system:Double x:Key="{x:Static SystemParameters.VerticalScrollBarWidthKey}">
                        10
                    </system:Double>
                    <Storyboard x:Key="CheckerIncreaseWidthAnimation" TargetProperty="(Grid.Width)" TargetName="CheckerSnackBar">
                        <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                         From="120" To="240" Duration="00:00:00.3" />
                    </Storyboard>
                    <Storyboard x:Key="CheckerDecreaseWidthAnimation" TargetProperty="(Grid.Width)" TargetName="CheckerSnackBar">
                        <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                         From="240" To="120" Duration="00:00:00.3" />
                    </Storyboard>
                    <Storyboard x:Key="CheckerOpacityMaskIncreaseWidthAnimation" TargetProperty="(Grid.Width)" TargetName="CheckerSnackBarOpacityMask">
                        <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                         From="120" To="240" Duration="00:00:00.3" />
                    </Storyboard>
                    <Storyboard x:Key="CheckerOpacityMaskDecreaseWidthAnimation" TargetProperty="(Grid.Width)" TargetName="CheckerSnackBarOpacityMask">
                        <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                         From="240" To="120" Duration="00:00:00.3" />
                    </Storyboard>
                </ScrollViewer.Resources>
                <StackPanel d:DataContext="{d:DesignData User}" Background="#FAFAFC">
                    <Grid Height="300" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                        <Image x:Name="UserBanner" HorizontalAlignment="Stretch" VerticalAlignment="Center"
                               Stretch="UniformToFill" />
                    </Grid>
                    <Grid Height="150" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="2*" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0" Margin="20,20,0,0" HorizontalAlignment="Left"
                              VerticalAlignment="Top">
                            <TextBlock x:Name="BackToMainPageButton" Cursor="Hand" FontFamily="/Resources/#iconfont"
                                       FontSize="30" MouseLeftButtonDown="BackToMainPageButton_OnMouseLeftButtonDown" Text="&#xe619;">
                                <TextBlock.Triggers>
                                    <EventTrigger RoutedEvent="TextBlock.MouseLeftButtonDown">
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(ScrollViewer.Opacity)" TargetName="UserBrowserPageScrollViewer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="1" To="0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)" TargetName="UserBrowserPageScrollViewer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="1" To="0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)" TargetName="UserBrowserPageScrollViewer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="1" To="0" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Grid.Opacity)" TargetName="ContentContainer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="0" To="1" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)" TargetName="ContentContainer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="0" To="1" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                        <BeginStoryboard>
                                            <Storyboard TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)" TargetName="ContentContainer">
                                                <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                 From="0" To="1" Duration="00:00:00.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </TextBlock.Triggers>
                            </TextBlock>
                        </Grid>
                        <Grid Grid.Column="0" Width="120" Height="120"
                              Margin="0,-30,0,0" HorizontalAlignment="Right" VerticalAlignment="Top">
                            <Image x:Name="UserBrowserUserAvatar" Stretch="UniformToFill">
                                <Image.Clip>
                                    <EllipseGeometry Center="60 60" RadiusX="60" RadiusY="60" />
                                </Image.Clip>
                            </Image>
                            <Ellipse Stroke="#FAFAFC" StrokeThickness="2" />
                        </Grid>
                        <StackPanel Grid.Column="1" Margin="20,0,40,20">
                            <Grid Height="90" VerticalAlignment="Top">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Row="0" VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock FontSize="20" Text="{Binding Name}" />
                                    <Border Width="70" Margin="10,2,0,2" VerticalAlignment="Stretch"
                                            Background="#FD9E16" CornerRadius="10"
                                            Visibility="{Binding IsPremium, Converter={StaticResource VisibleIfTrueConverter}}">
                                        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White">
                                            premium
                                        </TextBlock>
                                    </Border>
                                </StackPanel>
                                <StackPanel Grid.Row="1" Margin="0,5,0,0" VerticalAlignment="Top"
                                            Orientation="Horizontal">
                                    <TextBlock VerticalAlignment="Center" FontSize="15" Foreground="#03A9F4"
                                               Text="{Binding Follows}" />
                                    <TextBlock Margin="5,0,0,0" VerticalAlignment="Center" FontSize="15"
                                               Text="{x:Static i18N:AkaI18N.UserBrowserFollowCountHint}" />
                                    <Button x:Name="ShareUserButton" Width="30" Height="30"
                                            Margin="20,0,0,0" Cursor="Hand" PreviewMouseLeftButtonDown="ShareUserButton_OnPreviewMouseLeftButtonDown"
                                            Style="{DynamicResource MaterialDesignToolButton}">
                                        <TextBlock FontFamily="/Resources/#iconfont" FontSize="20" Text="&#xe661;" />
                                    </Button>
                                    <Button x:Name="ViewUserInBrowserButton" Width="30" Height="30"
                                            Margin="10,0,0,0" Cursor="Hand" PreviewMouseLeftButtonDown="ViewUserInBrowserButton_OnPreviewMouseLeftButtonDown"
                                            Style="{DynamicResource MaterialDesignToolButton}">
                                        <TextBlock FontFamily="/Resources/#iconfont" FontSize="20" Text="&#xe606;" />
                                    </Button>
                                </StackPanel>
                                <StackPanel Grid.Row="0" Grid.RowSpan="2" HorizontalAlignment="Right"
                                            Orientation="Horizontal">
                                    <Grid Width="120" Height="40">
                                        <Border Background="#66CCFF" CornerRadius="10"
                                                Visibility="{Binding IsFollowed, Converter={StaticResource VisibleIfFalseConverter}}">
                                            <Button x:Name="FollowButton" Width="120" Height="40"
                                                    Padding="30,0" Click="FollowButton_OnClick"
                                                    Style="{DynamicResource MaterialDesignToolButton}">
                                                <TextBlock Text="{x:Static i18N:AkaI18N.UserBrowserFollow}" />
                                            </Button>
                                        </Border>
                                        <Border Background="#FFCBCBCB" CornerRadius="10"
                                                Visibility="{Binding IsFollowed, Converter={StaticResource VisibleIfTrueConverter}}">
                                            <Button x:Name="UnFollowButton" Width="120" Height="40"
                                                    Padding="30,0" Click="UnFollowButton_OnClick"
                                                    Style="{DynamicResource MaterialDesignToolButton}">
                                                <TextBlock Text="{x:Static i18N:AkaI18N.UserBrowserUnFollow}" />
                                            </Button>
                                        </Border>
                                    </Grid>
                                    <materialDesign:PopupBox IsEnabled="{Binding IsFollowed, Converter={StaticResource InverseBooleanConverter}}" PopupMode="Click">
                                        <materialDesign:PopupBox.PopupContent>
                                            <Menu>
                                                <Menu.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel />
                                                    </ItemsPanelTemplate>
                                                </Menu.ItemsPanel>
                                                <MenuItem Click="PrivateFollow_OnClick" Header="{x:Static i18N:AkaI18N.UserBrowserPrivateFollow}" />
                                            </Menu>
                                        </materialDesign:PopupBox.PopupContent>
                                    </materialDesign:PopupBox>
                                </StackPanel>
                            </Grid>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock MaxWidth="600" Margin="20,0,0,0" HorizontalAlignment="Left"
                                           FontSize="15"
                                           Text="{Binding Introduction}"
                                           TextTrimming="CharacterEllipsis" />
                                <TextBlock x:Name="ViewIntroductionButton" Margin="20,0,0,0" Cursor="Hand"
                                           FontFamily="/Resources/#iconfont" FontSize="20" Text="&#xe660;" />
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                    <Separator Height="1" />
                    <Grid>
                        <Grid Width="240" Height="5" VerticalAlignment="Top">
                            <Grid x:Name="CheckerSnackBar" Width="120" Height="5"
                                  HorizontalAlignment="Left" Background="#0096FA" />
                        </Grid>
                        <Grid Width="240" Height="45" Margin="0,5,0,0"
                              VerticalAlignment="Bottom" Background="#FAFAFC">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="UploadChecker" Grid.Column="0" Width="120"
                                       HorizontalAlignment="Center" VerticalAlignment="Center" Cursor="Hand"
                                       FontFamily="Microsoft YaHei Light" FontSize="20" MouseLeftButtonDown="UploadChecker_OnMouseLeftButtonDown"
                                       Text="{x:Static i18N:AkaI18N.UserBrowserIllustSelector}"
                                       TextAlignment="Center" />
                            <TextBlock x:Name="GalleryChecker" Grid.Column="1" Width="120"
                                       HorizontalAlignment="Center" VerticalAlignment="Center" Cursor="Hand"
                                       FontFamily="Microsoft YaHei Light" FontSize="20" MouseLeftButtonDown="GalleryChecker_OnMouseLeftButtonDown"
                                       Text="{x:Static i18N:AkaI18N.UserBrowserGallerySelector}"
                                       TextAlignment="Center" />
                        </Grid>
                        <Grid Width="240" Height="45" VerticalAlignment="Bottom">
                            <Grid x:Name="CheckerSnackBarOpacityMask" Width="120" HorizontalAlignment="Left"
                                  Background="Gray" Opacity="0.2" />
                        </Grid>
                    </Grid>
                    <Grid Margin="0,20,0,0">
                        <ListView x:Name="UserIllustsImageListView" HorizontalAlignment="Stretch" Grid.ZIndex="1"
                                  ItemTemplate="{StaticResource IllustrationTemplate}"
                                  PreviewMouseWheel="UserIllustsImageListView_OnPreviewMouseWheel" ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.IsDeferredScrollingEnabled="True"
                                  VirtualizingPanel.CacheLength="0 0" VirtualizingPanel.CacheLengthUnit="Pixel" VirtualizingPanel.ScrollUnit="Pixel"
                                  VirtualizingPanel.VirtualizationMode="Standard">
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <controls:VirtualizingWrapPanel Orientation="Vertical" />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                        </ListView>
                    </Grid>
                </StackPanel>
            </ScrollViewer>
            <userControls:InputBoxControl x:Name="UserBrowserConditionInputBox"
                                          DataContext="{x:Static viewModel:ConditionString.Shared}"
                                          Grid.ZIndex="2" Visibility="Hidden" />
        </Grid>
        <materialDesign:DialogHost x:Name="PixevalSettingDialog" materialDesign:TransitionAssist.DisableTransitions="True" CloseOnClickAway="True"
                                   DataContext="{x:Static persisting:Settings.Global}"
                                   DialogClosing="PixevalSettingDialog_OnDialogClosing"
                                   Style="{DynamicResource MaterialDesignEmbeddedDialogHost}">
            <materialDesign:DialogHost.DialogContent>
                <userControls:PixevalSettingPage />
            </materialDesign:DialogHost.DialogContent>
        </materialDesign:DialogHost>
        <materialDesign:DialogHost x:Name="IllustBrowserDialogHost"
                                   d:DataContext="{d:DesignData Illustration}"
                                   materialDesign:TransitionAssist.DisableTransitions="True" CloseOnClickAway="True" DialogClosing="IllustBrowserDialogHost_OnDialogClosing"
                                   DialogMargin="0" DialogOpened="IllustBrowserDialogHost_OnDialogOpened"
                                   Style="{DynamicResource MaterialDesignEmbeddedDialogHost}">
            <materialDesign:DialogHost.DialogContent>
                <materialDesign:Card Background="#FAFAFC" BorderBrush="#FAFAFC">
                    <StackPanel x:Name="IllustBrowserContainer" Width="1000" Background="#FAFAFC">
                        <materialDesign:Card x:Name="Banner" Height="100" StackPanel.ZIndex="1">
                            <Grid Background="#FAFAFC">
                                <Image x:Name="IllustBrowserUserAvatar" Width="60" Height="60"
                                       Margin="20,20,0,20" HorizontalAlignment="Left" Cursor="Hand"
                                       MouseLeftButtonDown="ImageBrowserUserAvatar_OnMouseLeftButtonDown" Stretch="UniformToFill">
                                    <Image.Triggers>
                                        <EventTrigger RoutedEvent="Image.PreviewMouseLeftButtonDown">
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}" TargetProperty="(ScrollViewer.Opacity)">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="0" To="1" Duration="00:00:00.3" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}" TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleX)">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="0" To="1" Duration="00:00:00.3" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=UserBrowserPageScrollViewer}" TargetProperty="(ScrollViewer.RenderTransform).(ScaleTransform.ScaleY)">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="0" To="1" Duration="00:00:00.3" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=ContentContainer}" TargetProperty="(Grid.Opacity)">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="1" To="0" Duration="00:00:00.3" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=ContentContainer}" TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleX)">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="1" To="0" Duration="00:00:00.3" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                            <BeginStoryboard>
                                                <Storyboard Target="{Binding ElementName=ContentContainer}" TargetProperty="(Grid.RenderTransform).(ScaleTransform.ScaleY)">
                                                    <DoubleAnimation EasingFunction="{StaticResource CubicEase}"
                                                                     From="1" To="0" Duration="00:00:00.3" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Image.Triggers>
                                    <Image.Clip>
                                        <EllipseGeometry Center="30 30" RadiusX="30" RadiusY="30" />
                                    </Image.Clip>
                                </Image>
                                <StackPanel Margin="90,20,0,20">
                                    <TextBlock Margin="0,5,0,13" FontFamily="Microsoft YaHei Light" FontSize="15"
                                               Foreground="#03A9F4"
                                               Text="{Binding Title}" />
                                    <StackPanel Orientation="Horizontal">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Text="{Binding UserName}" />
                                        </StackPanel>
                                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                            <TextBlock Margin="50,0,0,0" FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Text="{x:Static i18N:AkaI18N.IllustBrowserIllustId}" />
                                            <TextBlock Margin="0,0,30,0" FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Foreground="#03A9F4"
                                                       Text="{Binding Id}" />
                                        </StackPanel>
                                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                            <TextBlock FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Text="{x:Static i18N:AkaI18N.IllustBrowserTotalViews}" />
                                            <TextBlock Margin="0,0,30,0" FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Foreground="#03A9F4"
                                                       Text="{Binding ViewCount}" />
                                        </StackPanel>
                                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                            <TextBlock FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Text="{x:Static i18N:AkaI18N.IllustBrowserTotalBookmarks}" />
                                            <TextBlock Margin="0,0,30,0" FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Foreground="#03A9F4"
                                                       Text="{Binding Bookmark}" />
                                        </StackPanel>
                                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                            <TextBlock FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Text="{x:Static i18N:AkaI18N.IllustBrowserResolution}" />
                                            <TextBlock Margin="0,0,30,0" FontFamily="Microsoft YaHei Light" FontSize="12"
                                                       Foreground="#03A9F4"
                                                       Text="{Binding Resolution}" />
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                        <materialDesign:Card Width="{Binding ElementName=Banner, Path=ActualWidth}"
                                             MaxWidth="{Binding ElementName=Banner, Path=ActualWidth}"
                                             Background="#FAFAFC" StackPanel.ZIndex="1">
                            <StackPanel Margin="0,0,0,10">
                                <StackPanel Margin="20" FlowDirection="LeftToRight" Orientation="Horizontal">
                                    <TextBlock FontFamily="Microsoft YaHei Light" FontSize="12"
                                               Text="{x:Static i18N:AkaI18N.IllustBrowserUploadDate}" />
                                    <TextBlock FontFamily="Microsoft YaHei Light" FontSize="12" Foreground="#03A9F4"
                                               Text="{Binding PublishDate, Converter={StaticResource DateTimeOffsetConverter}}" />
                                </StackPanel>
                                <TextBlock Margin="20,0,0,0" FontFamily="Microsoft YaHei Light" FontSize="12"
                                           Text="{x:Static i18N:AkaI18N.IllustBrowserIllustTag}" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2.5*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <ListView Grid.Column="0" Margin="20,0,0,0"
                                              ItemsSource="{Binding Tags}"
                                              ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListView.ItemTemplate>
                                            <DataTemplate DataType="viewModel:Tag">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock FontSize="10">
                                                        <Hyperlink x:Name="TagNavigateHyperlink" Click="TagNavigateHyperlink_OnClick" Foreground="#03A9F4">
                                                            <TextBlock Text="{Binding Name, StringFormat='{}#={0}'}" />
                                                        </Hyperlink>
                                                    </TextBlock>
                                                    <TextBlock Margin="5,0,0,0" FontSize="10"
                                                               Text="{Binding TranslatedName}" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                        <ListView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel />
                                            </ItemsPanelTemplate>
                                        </ListView.ItemsPanel>
                                    </ListView>
                                    <StackPanel Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Top"
                                                FlowDirection="RightToLeft" Orientation="Horizontal">
                                        <StackPanel.Resources>
                                            <Style x:Key="TextBlockStyle"
                                                   BasedOn="{StaticResource MaterialDesignBody1TextBlock}"
                                                   TargetType="TextBlock">
                                                <Setter Property="FontSize" Value="20" />
                                                <Setter Property="Foreground" Value="#03A9F4" />
                                                <Setter Property="FontFamily" Value="/Resources/#iconfont" />
                                                <Setter Property="Cursor" Value="Hand" />
                                                <Setter Property="Height" Value="30" />
                                                <Setter Property="Width" Value="30" />
                                                <Setter Property="Margin" Value="5,0,0,0" />
                                            </Style>
                                        </StackPanel.Resources>
                                        <TextBlock x:Name="SetAsWallPaperButton" Margin="10,0,0,0" FontFamily="/Resources/#dqueue"
                                                   MouseLeftButtonDown="SetAsWallPaperButton_OnMouseLeftButtonDown"
                                                   Style="{StaticResource TextBlockStyle}"
                                                   Text="&#xe635;"
                                                   ToolTip="{x:Static i18N:AkaI18N.IllustBrowserSetWallpaper}" />
                                        <TextBlock x:Name="ShareButton" MouseLeftButtonDown="ShareButton_OnMouseLeftButtonDown"
                                                   Style="{StaticResource TextBlockStyle}"
                                                   Text="&#xe661;"
                                                   ToolTip="{x:Static i18N:AkaI18N.IllustBrowserShareLink}" />
                                        <TextBlock x:Name="ViewInBrowserButton" MouseLeftButtonDown="ViewInBrowserButton_OnMouseLeftButtonDown"
                                                   Style="{StaticResource TextBlockStyle}"
                                                   Text="&#xe606;"
                                                   ToolTip="{x:Static i18N:AkaI18N.IllustBrowserViewInBrowser}" />
                                        <Grid>
                                            <TextBlock x:Name="DownloadButton" MouseLeftButtonDown="DownloadButton_OnMouseLeftButtonDown"
                                                       Style="{StaticResource TextBlockStyle}"
                                                       Text="&#xe60a;"
                                                       ToolTip="{x:Static i18N:AkaI18N.IllustBrowserDownload}" />
                                        </Grid>
                                        <TextBlock x:Name="IllustBrowserPrivateFavorButton" FontFamily="/Resources/#dqueue"
                                                   IsEnabled="{Binding IsLiked, Converter={StaticResource InverseBooleanConverter}}"
                                                   MouseLeftButtonDown="IllustBrowserPrivateFavorButton_OnMouseLeftButtonDown"
                                                   Style="{StaticResource TextBlockStyle}"
                                                   Text="&#xebc2;"
                                                   ToolTip="{x:Static i18N:AkaI18N.IllustBrowserPrivateBookmark}" />
                                        <Grid>
                                            <TextBlock x:Name="IllustBrowserFavorButton" MouseLeftButtonDown="IllustBrowserFavorButton_OnMouseLeftButtonDown"
                                                       Style="{StaticResource TextBlockStyle}"
                                                       Text="&#xe63e;"
                                                       ToolTip="{x:Static i18N:AkaI18N.IllustBrowserBookmark}"
                                                       Visibility="{Binding IsLiked, Converter={StaticResource VisibleIfFalseConverter}}" />
                                            <TextBlock x:Name="IllustBrowserDisfavorButton" MouseLeftButtonDown="IllustBrowserDisfavorButton_OnMouseLeftButtonDown"
                                                       Style="{StaticResource TextBlockStyle}"
                                                       Text="&#xeb4c;"
                                                       ToolTip="{x:Static i18N:AkaI18N.IllustBrowserRemoveBookmark}"
                                                       Visibility="{Binding IsLiked, Converter={StaticResource VisibleIfTrueConverter}}" />
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </materialDesign:Card>
                    </StackPanel>
                </materialDesign:Card>
            </materialDesign:DialogHost.DialogContent>
        </materialDesign:DialogHost>
        <materialDesign:DialogHost x:Name="DownloadQueueDialogHost"
                                   d:DataContext="{d:DesignData DownloadableIllustrationViewModel}"
                                   materialDesign:TransitionAssist.DisableTransitions="True" CloseOnClickAway="True" DialogClosing="DownloadQueueDialogHost_OnDialogClosing"
                                   Style="{DynamicResource MaterialDesignEmbeddedDialogHost}">
            <materialDesign:DialogHost.DialogContent>
                <userControls:DownloadQueue Width="800" Height="450" />
            </materialDesign:DialogHost.DialogContent>
        </materialDesign:DialogHost>
        <materialDesign:Snackbar x:Name="MainWindowSnackBar" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Black"
              Opacity="0.15"
              Visibility="{Binding ElementName=TrendingTagPopup, Path=IsOpen, Converter={StaticResource VisibleIfTrueConverter}}" />
    </Grid>
</Window>